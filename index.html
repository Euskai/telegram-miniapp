<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YTnews</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; background-color: #1a1a1a; color: white; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; height: 100vh; }
        
        /* Contenedor de mensajes (Chatbot) */
        #chat-window { width: 100%; max-width: 400px; height: 150px; background: #2c2c2c; border-radius: 10px; margin-bottom: 20px; padding: 10px; overflow-y: auto; border: 1px solid #7d5fff; font-size: 14px; }
        .msg { margin-bottom: 8px; }
        .bot-msg { color: #a29bfe; }

        /* Vistas */
        .view { display: none; width: 100%; max-width: 400px; flex-direction: column; gap: 10px; }
        .active { display: flex; }

        /* Botones */
        button { background-color: #2c2c2c; border: 2px solid #7d5fff; color: #a29bfe; padding: 15px; border-radius: 8px; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 11px; }
        .row { display: flex; gap: 10px; }
        .row button { flex: 1; }
        
        /* Botón de Entrada (Amarillo/Negro) */
        #btn-entrar { background-color: #ffff00; color: #000000; border: none; font-size: 18px; padding: 20px; width: 100%; }
        #btn-entrar span { display: block; font-size: 12px; }
    </style>
</head>
<body>

    <div id="chat-window">
        <div class="msg bot-msg">YTnews: Esperando instrucción...</div>
    </div>

    <div id="vista-entrada" class="view active">
        <button id="btn-entrar" onclick="mostrarMenu()">
            DESCARGAR EN 
            <span style="font-size: 24px;">APP STORE</span>
        </button>
    </div>

    <div id="vista-menu" class="view">
        <div class="row">
            <button onclick="enviarDatos('COMENZAR')">COMENZAR</button>
            <button onclick="enviarDatos('VIDEO INDIVIDUAL')">VIDEO INDIVIDUAL</button>
            <button onclick="enviarDatos('EXTRAER CANAL')">EXTRAER CANAL</button>
        </div>
        <button onclick="enviarDatos('EXTRAER TEXTO / WEB')">EXTRAER TEXTO / WEB</button>
        <div class="row">
            <button onclick="enviarDatos('INFORMACIÓN Y ESTADÍSTICAS')">INFORMACIÓN Y ESTADÍSTICAS</button>
            <button onclick="enviarDatos('HORA DE LANZAMIENTO')">HORA DE LANZAMIENTO</button>
        </div>
        <div class="row">
            <button onclick="enviarDatos('LISTA DE CANALES')">LISTA DE CANALES</button>
            <button onclick="enviarDatos('AÑADIR CANAL')">AÑADIR CANAL</button>
            <button onclick="enviarDatos('ELIMINAR CANAL')">ELIMINAR CANAL</button>
        </div>
    </div>

    <script>
        const webapp = window.Telegram.WebApp;
        webapp.ready();

        function mostrarMenu() {
            document.getElementById('vista-entrada').classList.remove('active');
            document.getElementById('vista-menu').classList.add('active');
        }

        function agregarMensaje(texto) {
            const chat = document.getElementById('chat-window');
            const div = document.createElement('div');
            div.className = 'msg bot-msg';
            div.innerText = "Respuesta: " + texto;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }

        function enviarDatos(nombreBoton) {
            agregarMensaje("Procesando " + nombreBoton + "...");
            
            fetch('https://n8n.euskai.net/webhook/tu-id-aqui', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    boton_pulsado: nombreBoton,
                    user_id: webapp.initDataUnsafe.user?.id 
                })
            })
            .then(response => response.json())
            .then(data => {
                if(data.respuesta) agregarMensaje(data.respuesta);
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
</body>
</html>
